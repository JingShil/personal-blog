{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Vditor from 'vditor';\n// 1.2 引入样式\nimport 'vditor/dist/index.css';\nimport { ref, onMounted } from 'vue';\nexport default {\n  __name: 'Index',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n\n    // 1.1 引入Vditor 构造函数\n    const vditor = ref();\n    let catalogs = ref([]);\n    let menu = ref(0);\n    let tags = ref([]);\n\n    // 3. 在组件初始化时，就创建Vditor对象，并引用\n    onMounted(() => {\n      vditor.value = new Vditor('vditor', {\n        // height: '200px',\n        width: '100%',\n        height: '80vh',\n        tab: \"\\t\",\n        // \"outline\": {\n        // \t\"enable\": true\n        // },\n        toolbar: ['emoji', 'headings', 'bold', 'italic', 'strike', '|', 'line', 'quote', 'list', 'ordered-list', 'check', 'code', 'inline-code', 'insert-after', 'insert-before', 'undo', 'redo', 'link', 'table', 'edit-mode', 'both', 'content-theme', 'export'],\n        input(value) {\n          getCatalog();\n        },\n        after() {\n          getCatalog();\n        }\n      });\n    });\n    function getMarkdown() {\n      const markdown = vditor.value.getValue();\n      console.log(markdown);\n    }\n    function getMarkdown1() {\n      const markdown = vditor.value.exportJSON(vditor.value.getValue());\n      console.log(markdown);\n    }\n    function getCatalog() {\n      //给标题附上id\n      const vditorModel = vditor.value.getCurrentMode();\n      const article_contents = document.getElementsByClassName(\"vditor-reset\");\n      const titleTag = [\"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\"];\n      let article_content = null;\n      let article_content2 = null;\n      let model = 'ir';\n      article_content = article_contents[2];\n      if (vditorModel === 'wysiwyg') {\n        article_content2 = article_contents[0];\n        model = 'wysiwyg';\n      } else if (vditorModel === 'sv') {\n        article_content2 = article_contents[1];\n        model = 'sv';\n      } else if (vditorModel === 'ir') {\n        article_content2 = article_contents[2];\n        model = 'ir';\n      }\n      // console.log(article_content)\n      let i = 0;\n      let ids = [];\n      article_content.childNodes.forEach((e, index) => {\n        // console.log(e);\n        // console.log(article_content2.childNodes[index]);\n        if (titleTag.includes(e.nodeName)) {\n          const id = model + \"-\" + index;\n          ids.push(id);\n          console.log(e);\n          console.log(article_content2.childNodes[index]);\n          article_content2.childNodes[index].id = id;\n        }\n      });\n\n      //根据HTML内容，生成树\n      const article_content1 = new DOMParser().parseFromString(vditor.value.getHTML(), \"text/html\");\n      const titleTag1 = [\"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\"];\n      let titles = [];\n      // 将childNodes转换为数组\n      const childNodesArray = Array.from(article_content1.body.childNodes);\n      let pre = 1;\n      let now = 0;\n      let count = 1;\n      let num = 0;\n      childNodesArray.forEach((e, index) => {\n        if (titleTag.includes(e.nodeName)) {\n          const id = ids[num++];\n          now = Number(e.nodeName.substring(1, 2));\n          if (pre > now) {\n            count--;\n          } else if (pre < now) {\n            count++;\n          }\n          pre = now;\n          titles.push({\n            id: id,\n            title: e.innerHTML,\n            level: count,\n            nodeName: e.nodeName\n          });\n        }\n      });\n      catalogs.value = titles;\n    }\n    function scrollTo(sectionId) {\n      const element = document.getElementById(sectionId);\n      if (element) {\n        console.log(sectionId);\n        element.scrollIntoView({\n          behavior: 'instant'\n        });\n      }\n    }\n    const __returned__ = {\n      vditor,\n      get catalogs() {\n        return catalogs;\n      },\n      set catalogs(v) {\n        catalogs = v;\n      },\n      get menu() {\n        return menu;\n      },\n      set menu(v) {\n        menu = v;\n      },\n      get tags() {\n        return tags;\n      },\n      set tags(v) {\n        tags = v;\n      },\n      getMarkdown,\n      getMarkdown1,\n      getCatalog,\n      scrollTo,\n      get Vditor() {\n        return Vditor;\n      },\n      ref,\n      onMounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["Vditor","ref","onMounted","vditor","catalogs","menu","tags","value","width","height","tab","toolbar","input","getCatalog","after","getMarkdown","markdown","getValue","console","log","getMarkdown1","exportJSON","vditorModel","getCurrentMode","article_contents","document","getElementsByClassName","titleTag","article_content","article_content2","model","i","ids","childNodes","forEach","e","index","includes","nodeName","id","push","article_content1","DOMParser","parseFromString","getHTML","titleTag1","titles","childNodesArray","Array","from","body","pre","now","count","num","Number","substring","title","innerHTML","level","scrollTo","sectionId","element","getElementById","scrollIntoView","behavior"],"sources":["E:/java项目/test/blog/blog-front/src/views/edit/Index.vue"],"sourcesContent":["<template>\r\n\t<div class=\"edit-body\">\r\n\t\t<div class=\"edit-head\">\r\n\t\t\t<div class=\"edit-title-input\">\r\n\t\t\t\t<input placeholder=\"请输入标题\" maxlength=\"100\" />\r\n\t\t\t\t<span>0/100</span>\r\n\t\t\t</div>\r\n\t\t\t<el-button class=\"edit-save\" @click=\"getCatalog\">保存</el-button>\r\n\t\t\t<el-button type=\"primary\" @click=\"getMarkdown1\">发布</el-button>\r\n\t\t\t<img src=\"../../assets/imgs/fufu.jpg\" style=\"height: 40px;margin-left: 20px;border-radius: 30px;\">\r\n\t\t</div>\r\n\t\t<div class=\"edit-container\">\r\n\t\t\t<div class=\"edit-left\">\r\n\t\t\t\t<div class=\"edit-content\" id=\"vditor\" ref=\"article\"></div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"edit-right\">\r\n\t\t\t\t<div class=\"edit-help\">\r\n\t\t\t\t\t<div class=\"edit-help-item\">\r\n\t\t\t\t\t\t<img src=\"../../assets/imgs/目录.svg\">\r\n\t\t\t\t\t\t<span>目录</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"edit-help-item\">\r\n\t\t\t\t\t\t<img src=\"../../assets/imgs/标签.svg\">\r\n\t\t\t\t\t\t<span>标签</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"edit-help-item\">\r\n\t\t\t\t\t\t<img src=\"../../assets/imgs/AI-chat.svg\">\r\n\t\t\t\t\t\t<span>AI助手</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"edit-help-item\">\r\n\t\t\t\t\t\t<img src=\"../../assets/imgs/帮助与说明.svg\">\r\n\t\t\t\t\t\t<span>语法说明</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"edit-help-content\">\r\n\t\t\t\t\t<!-- {{ catalog }} -->\r\n\t\t\t\t\t<div class=\"edit-help-content-item\"  v-if=\"menu==1\">\r\n\t\t\t\t\t\t<div class=\"edit-help-content-head\">\r\n\t\t\t\t\t\t\t<span>文章目录</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"edit-help-catalog\">\r\n\t\t\t\t\t\t\t<div class=\"edit-help-catalog-for\" v-for=\"(catalog, index) in catalogs\" :key=\"index\">\r\n\t\t\t\t\t\t\t\t<span :id=\"catalog.id\" :style=\"{ marginLeft: catalog.level * 20 + 'px'}\" @click=\"scrollTo(catalog.id)\">{{ catalog.title }}</span>\r\n\t\t\t\t\t\t\t\t<!-- <a :href=\"catalog.id\"  :style=\"{ marginLeft: catalog.level * 20 + 'px'}\">{{ catalog.title }}</a> -->\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div class=\"edit-help-content-item\" v-if=\"menu==0\">\r\n\t\t\t\t\t\t<div class=\"edit-help-content-head\">\r\n\t\t\t\t\t\t\t<span>标签</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"edit-help-tag\">\r\n\t\t\t\t\t\t\t<div class=\"edit-help-tag-for\" v-for=\"(tag, index) in tags\" :key=\"index\">\r\n\t\t\t\t\t\t\t\t<el-tag type=\"primary\">Tag 1</el-tag>\r\n\t\t\t\t\t\t\t\t<!-- <a :href=\"catalog.id\"  :style=\"{ marginLeft: catalog.level * 20 + 'px'}\">{{ catalog.title }}</a> -->\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t\r\n\t\t</div>\r\n\t</div>\r\n\t\r\n\t\r\n</template>\r\n\r\n<script setup>\r\n// 1.1 引入Vditor 构造函数\r\nimport Vditor from 'vditor'\r\n// 1.2 引入样式\r\nimport 'vditor/dist/index.css';\r\nimport { ref, onMounted } from 'vue';\r\n\r\nconst vditor = ref()\r\nlet catalogs = ref([])\r\n\r\nlet menu=ref(0);\t\r\nlet tags=ref([]);\r\n\r\n\r\n// 3. 在组件初始化时，就创建Vditor对象，并引用\r\nonMounted(() => {\r\n\tvditor.value = new Vditor('vditor',{\r\n\t\t// height: '200px',\r\n\t\twidth: '100%',\r\n\t\theight: '80vh',\r\n\t\ttab:\"\\t\",\r\n\t\t// \"outline\": {\r\n\t\t// \t\"enable\": true\r\n\t\t// },\r\n\t\ttoolbar: [\r\n\t\t\t'emoji','headings','bold','italic','strike','|','line','quote','list','ordered-list','check',\r\n\t\t\t'code','inline-code','insert-after','insert-before','undo','redo','link','table','edit-mode',\r\n\t\t\t'both','content-theme','export',\r\n\t\t\t\r\n\r\n\t\t],\r\n\t\t\r\n\t\tinput(value){\r\n\t\t\tgetCatalog();\r\n\t\t},\r\n\t\tafter(){\r\n\t\t\tgetCatalog();\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t})\r\n\r\n\t\r\n\t\r\n})\r\n\r\n\r\n\r\n\r\nfunction getMarkdown(){\r\n\tconst markdown = vditor.value.getValue();\r\n\tconsole.log(markdown);\r\n}\r\n\r\nfunction getMarkdown1(){\r\n\tconst markdown = vditor.value.exportJSON(vditor.value.getValue());\r\n\tconsole.log(markdown);\r\n}\r\n\r\nfunction getCatalog(){\r\n\t//给标题附上id\r\n\tconst vditorModel = vditor.value.getCurrentMode();\r\n\t\r\n\tconst article_contents = document.getElementsByClassName(\"vditor-reset\");\r\n\tconst titleTag = [\"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\"];\r\n\tlet article_content = null;\r\n\tlet article_content2 = null;\r\n\tlet model='ir';\r\n\tarticle_content = article_contents[2];\r\n\tif(vditorModel === 'wysiwyg'){\r\n\t\tarticle_content2 = article_contents[0];\r\n\t\tmodel='wysiwyg';\r\n\t}else if(vditorModel === 'sv'){\r\n\t\tarticle_content2 = article_contents[1];\r\n\t\tmodel='sv';\r\n\t}else if(vditorModel === 'ir'){\r\n\t\tarticle_content2 = article_contents[2];\r\n\t\tmodel='ir';\r\n\t}\r\n\t// console.log(article_content)\r\n\tlet i=0;\r\n\tlet ids=[]\r\n\tarticle_content.childNodes.forEach((e,index)=>{\r\n\t\t// console.log(e);\r\n\t\t// console.log(article_content2.childNodes[index]);\r\n\t\tif (titleTag.includes(e.nodeName)) {\r\n\t\t\tconst id = model + \"-\" + index;\r\n\t\t\tids.push(id)\r\n\t\t\tconsole.log(e);\r\n\t\t\tconsole.log(article_content2.childNodes[index]);\r\n\t\t\tarticle_content2.childNodes[index].id=id\r\n\t\t}\r\n\t})\r\n\t\r\n\t//根据HTML内容，生成树\r\n\tconst article_content1 = new DOMParser().parseFromString(vditor.value.getHTML(), \"text/html\");\r\n\tconst titleTag1 = [\"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\"];\r\n\r\n\tlet titles = [];\r\n\t// 将childNodes转换为数组\r\n\tconst childNodesArray = Array.from(article_content1.body.childNodes);\r\n\tlet pre=1;\r\n\tlet now=0;\r\n\tlet count=1;\r\n\tlet num=0;\r\n\tchildNodesArray.forEach((e, index) => {\r\n\t\tif (titleTag.includes(e.nodeName)) {\r\n\t\t\tconst id = ids[num++];\r\n\t\t\tnow=Number(e.nodeName.substring(1, 2));\r\n\t\t\tif(pre>now){\r\n\t\t\t\tcount--;\r\n\t\t\t}else if(pre<now){\r\n\t\t\t\tcount++;\r\n\t\t\t}\r\n\t\t\tpre=now;\r\n\t\t\ttitles.push({\r\n\t\t\t\tid: id,\r\n\t\t\t\ttitle: e.innerHTML,\r\n\t\t\t\tlevel: count,\r\n\t\t\t\tnodeName: e.nodeName\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\t\r\n\tcatalogs.value = titles;\r\n\t\r\n\t\r\n\r\n}\r\n\r\nfunction scrollTo(sectionId) {\r\n\t\r\n\tconst element = document.getElementById(sectionId);\r\n\tif (element) {\r\n\t\tconsole.log(sectionId)\r\n\t\telement.scrollIntoView({ behavior: 'instant'});\r\n\t}\r\n}\r\n\r\n\r\n\r\n</script>\r\n\r\n\r\n<style src=\"../../assets/css/edit.css\" scoped>\r\n\r\n</style>"],"mappings":";AAwEA,OAAOA,MAAM,MAAM,QAAQ;AAC3B;AACA,OAAO,uBAAuB;AAC9B,SAASC,GAAG,EAAEC,SAAS,QAAQ,KAAK;;;;;;;;IAJpC;IAMA,MAAMC,MAAM,GAAGF,GAAG,CAAC,CAAC;IACpB,IAAIG,QAAQ,GAAGH,GAAG,CAAC,EAAE,CAAC;IAEtB,IAAII,IAAI,GAACJ,GAAG,CAAC,CAAC,CAAC;IACf,IAAIK,IAAI,GAACL,GAAG,CAAC,EAAE,CAAC;;IAGhB;IACAC,SAAS,CAAC,MAAM;MACfC,MAAM,CAACI,KAAK,GAAG,IAAIP,MAAM,CAAC,QAAQ,EAAC;QAClC;QACAQ,KAAK,EAAE,MAAM;QACbC,MAAM,EAAE,MAAM;QACdC,GAAG,EAAC,IAAI;QACR;QACA;QACA;QACAC,OAAO,EAAE,CACR,OAAO,EAAC,UAAU,EAAC,MAAM,EAAC,QAAQ,EAAC,QAAQ,EAAC,GAAG,EAAC,MAAM,EAAC,OAAO,EAAC,MAAM,EAAC,cAAc,EAAC,OAAO,EAC5F,MAAM,EAAC,aAAa,EAAC,cAAc,EAAC,eAAe,EAAC,MAAM,EAAC,MAAM,EAAC,MAAM,EAAC,OAAO,EAAC,WAAW,EAC5F,MAAM,EAAC,eAAe,EAAC,QAAQ,CAG/B;QAEDC,KAAKA,CAACL,KAAK,EAAC;UACXM,UAAU,CAAC,CAAC;QACb,CAAC;QACDC,KAAKA,CAAA,EAAE;UACND,UAAU,CAAC,CAAC;QACb;MAGD,CAAC,CAAC;IAIH,CAAC,CAAC;IAKF,SAASE,WAAWA,CAAA,EAAE;MACrB,MAAMC,QAAQ,GAAGb,MAAM,CAACI,KAAK,CAACU,QAAQ,CAAC,CAAC;MACxCC,OAAO,CAACC,GAAG,CAACH,QAAQ,CAAC;IACtB;IAEA,SAASI,YAAYA,CAAA,EAAE;MACtB,MAAMJ,QAAQ,GAAGb,MAAM,CAACI,KAAK,CAACc,UAAU,CAAClB,MAAM,CAACI,KAAK,CAACU,QAAQ,CAAC,CAAC,CAAC;MACjEC,OAAO,CAACC,GAAG,CAACH,QAAQ,CAAC;IACtB;IAEA,SAASH,UAAUA,CAAA,EAAE;MACpB;MACA,MAAMS,WAAW,GAAGnB,MAAM,CAACI,KAAK,CAACgB,cAAc,CAAC,CAAC;MAEjD,MAAMC,gBAAgB,GAAGC,QAAQ,CAACC,sBAAsB,CAAC,cAAc,CAAC;MACxE,MAAMC,QAAQ,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;MACrD,IAAIC,eAAe,GAAG,IAAI;MAC1B,IAAIC,gBAAgB,GAAG,IAAI;MAC3B,IAAIC,KAAK,GAAC,IAAI;MACdF,eAAe,GAAGJ,gBAAgB,CAAC,CAAC,CAAC;MACrC,IAAGF,WAAW,KAAK,SAAS,EAAC;QAC5BO,gBAAgB,GAAGL,gBAAgB,CAAC,CAAC,CAAC;QACtCM,KAAK,GAAC,SAAS;MAChB,CAAC,MAAK,IAAGR,WAAW,KAAK,IAAI,EAAC;QAC7BO,gBAAgB,GAAGL,gBAAgB,CAAC,CAAC,CAAC;QACtCM,KAAK,GAAC,IAAI;MACX,CAAC,MAAK,IAAGR,WAAW,KAAK,IAAI,EAAC;QAC7BO,gBAAgB,GAAGL,gBAAgB,CAAC,CAAC,CAAC;QACtCM,KAAK,GAAC,IAAI;MACX;MACA;MACA,IAAIC,CAAC,GAAC,CAAC;MACP,IAAIC,GAAG,GAAC,EAAE;MACVJ,eAAe,CAACK,UAAU,CAACC,OAAO,CAAC,CAACC,CAAC,EAACC,KAAK,KAAG;QAC7C;QACA;QACA,IAAIT,QAAQ,CAACU,QAAQ,CAACF,CAAC,CAACG,QAAQ,CAAC,EAAE;UAClC,MAAMC,EAAE,GAAGT,KAAK,GAAG,GAAG,GAAGM,KAAK;UAC9BJ,GAAG,CAACQ,IAAI,CAACD,EAAE,CAAC;UACZrB,OAAO,CAACC,GAAG,CAACgB,CAAC,CAAC;UACdjB,OAAO,CAACC,GAAG,CAACU,gBAAgB,CAACI,UAAU,CAACG,KAAK,CAAC,CAAC;UAC/CP,gBAAgB,CAACI,UAAU,CAACG,KAAK,CAAC,CAACG,EAAE,GAACA,EAAE;QACzC;MACD,CAAC,CAAC;;MAEF;MACA,MAAME,gBAAgB,GAAG,IAAIC,SAAS,CAAC,CAAC,CAACC,eAAe,CAACxC,MAAM,CAACI,KAAK,CAACqC,OAAO,CAAC,CAAC,EAAE,WAAW,CAAC;MAC7F,MAAMC,SAAS,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;MAEtD,IAAIC,MAAM,GAAG,EAAE;MACf;MACA,MAAMC,eAAe,GAAGC,KAAK,CAACC,IAAI,CAACR,gBAAgB,CAACS,IAAI,CAACjB,UAAU,CAAC;MACpE,IAAIkB,GAAG,GAAC,CAAC;MACT,IAAIC,GAAG,GAAC,CAAC;MACT,IAAIC,KAAK,GAAC,CAAC;MACX,IAAIC,GAAG,GAAC,CAAC;MACTP,eAAe,CAACb,OAAO,CAAC,CAACC,CAAC,EAAEC,KAAK,KAAK;QACrC,IAAIT,QAAQ,CAACU,QAAQ,CAACF,CAAC,CAACG,QAAQ,CAAC,EAAE;UAClC,MAAMC,EAAE,GAAGP,GAAG,CAACsB,GAAG,EAAE,CAAC;UACrBF,GAAG,GAACG,MAAM,CAACpB,CAAC,CAACG,QAAQ,CAACkB,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;UACtC,IAAGL,GAAG,GAACC,GAAG,EAAC;YACVC,KAAK,EAAE;UACR,CAAC,MAAK,IAAGF,GAAG,GAACC,GAAG,EAAC;YAChBC,KAAK,EAAE;UACR;UACAF,GAAG,GAACC,GAAG;UACPN,MAAM,CAACN,IAAI,CAAC;YACXD,EAAE,EAAEA,EAAE;YACNkB,KAAK,EAAEtB,CAAC,CAACuB,SAAS;YAClBC,KAAK,EAAEN,KAAK;YACZf,QAAQ,EAAEH,CAAC,CAACG;UACb,CAAC,CAAC;QACH;MACD,CAAC,CAAC;MAEFlC,QAAQ,CAACG,KAAK,GAAGuC,MAAM;IAIxB;IAEA,SAASc,QAAQA,CAACC,SAAS,EAAE;MAE5B,MAAMC,OAAO,GAAGrC,QAAQ,CAACsC,cAAc,CAACF,SAAS,CAAC;MAClD,IAAIC,OAAO,EAAE;QACZ5C,OAAO,CAACC,GAAG,CAAC0C,SAAS,CAAC;QACtBC,OAAO,CAACE,cAAc,CAAC;UAAEC,QAAQ,EAAE;QAAS,CAAC,CAAC;MAC/C;IACD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}