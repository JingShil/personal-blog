{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineComponent, Fragment, ref, h, provide, reactive } from 'vue';\nimport { createId } from 'seemly';\nimport { useClicked, useClickPosition } from 'vooks';\nimport { omit } from \"../../_utils/index.mjs\";\nimport { NModalEnvironment } from \"./ModalEnvironment.mjs\";\nimport { modalApiInjectionKey, modalProviderInjectionKey, modalReactiveListInjectionKey } from \"./context.mjs\";\nexport const modalProviderProps = {\n  to: [String, Object]\n};\nexport const NModalProvider = defineComponent({\n  name: 'ModalProvider',\n  props: modalProviderProps,\n  setup() {\n    const clickedRef = useClicked(64);\n    const clickedPositionRef = useClickPosition();\n    const modalListRef = ref([]);\n    const modalInstRefs = {};\n    function create(options = {}) {\n      const key = createId();\n      const modalReactive = reactive(Object.assign(Object.assign({}, options), {\n        key,\n        destroy: () => {\n          modalInstRefs[`n-modal-${key}`].hide();\n        }\n      }));\n      modalListRef.value.push(modalReactive);\n      return modalReactive;\n    }\n    function handleAfterLeave(key) {\n      const {\n        value: modalList\n      } = modalListRef;\n      modalList.splice(modalList.findIndex(modal => modal.key === key), 1);\n    }\n    function destroyAll() {\n      Object.values(modalInstRefs).forEach(modalInstRef => {\n        modalInstRef.hide();\n      });\n    }\n    const api = {\n      create,\n      destroyAll\n    };\n    provide(modalApiInjectionKey, api);\n    provide(modalProviderInjectionKey, {\n      clickedRef: useClicked(64),\n      clickedPositionRef: useClickPosition()\n    });\n    provide(modalReactiveListInjectionKey, modalListRef);\n    provide(modalProviderInjectionKey, {\n      clickedRef,\n      clickedPositionRef\n    });\n    return Object.assign(Object.assign({}, api), {\n      modalList: modalListRef,\n      modalInstRefs,\n      handleAfterLeave\n    });\n  },\n  render() {\n    var _a, _b;\n    return h(Fragment, null, [this.modalList.map(modal => {\n      var _a;\n      return h(NModalEnvironment, omit(modal, ['destroy', 'style'], {\n        internalStyle: modal.style,\n        to: (_a = modal.to) !== null && _a !== void 0 ? _a : this.to,\n        ref: inst => {\n          if (inst === null) {\n            // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n            delete this.modalInstRefs[`n-modal-${modal.key}`];\n          } else {\n            this.modalInstRefs[`n-modal-${modal.key}`] = inst;\n          }\n        },\n        internalKey: modal.key,\n        onInternalAfterLeave: this.handleAfterLeave\n      }));\n    }), (_b = (_a = this.$slots).default) === null || _b === void 0 ? void 0 : _b.call(_a)]);\n  }\n});","map":{"version":3,"names":["defineComponent","Fragment","ref","h","provide","reactive","createId","useClicked","useClickPosition","omit","NModalEnvironment","modalApiInjectionKey","modalProviderInjectionKey","modalReactiveListInjectionKey","modalProviderProps","to","String","Object","NModalProvider","name","props","setup","clickedRef","clickedPositionRef","modalListRef","modalInstRefs","create","options","key","modalReactive","assign","destroy","hide","value","push","handleAfterLeave","modalList","splice","findIndex","modal","destroyAll","values","forEach","modalInstRef","api","render","_a","_b","map","internalStyle","style","inst","internalKey","onInternalAfterLeave","$slots","default","call"],"sources":["E:/java项目/test/blog/blog-front/node_modules/naive-ui/es/modal/src/ModalProvider.mjs"],"sourcesContent":["import { defineComponent, Fragment, ref, h, provide, reactive } from 'vue';\nimport { createId } from 'seemly';\nimport { useClicked, useClickPosition } from 'vooks';\nimport { omit } from \"../../_utils/index.mjs\";\nimport { NModalEnvironment } from \"./ModalEnvironment.mjs\";\nimport { modalApiInjectionKey, modalProviderInjectionKey, modalReactiveListInjectionKey } from \"./context.mjs\";\nexport const modalProviderProps = {\n  to: [String, Object]\n};\nexport const NModalProvider = defineComponent({\n  name: 'ModalProvider',\n  props: modalProviderProps,\n  setup() {\n    const clickedRef = useClicked(64);\n    const clickedPositionRef = useClickPosition();\n    const modalListRef = ref([]);\n    const modalInstRefs = {};\n    function create(options = {}) {\n      const key = createId();\n      const modalReactive = reactive(Object.assign(Object.assign({}, options), {\n        key,\n        destroy: () => {\n          modalInstRefs[`n-modal-${key}`].hide();\n        }\n      }));\n      modalListRef.value.push(modalReactive);\n      return modalReactive;\n    }\n    function handleAfterLeave(key) {\n      const {\n        value: modalList\n      } = modalListRef;\n      modalList.splice(modalList.findIndex(modal => modal.key === key), 1);\n    }\n    function destroyAll() {\n      Object.values(modalInstRefs).forEach(modalInstRef => {\n        modalInstRef.hide();\n      });\n    }\n    const api = {\n      create,\n      destroyAll\n    };\n    provide(modalApiInjectionKey, api);\n    provide(modalProviderInjectionKey, {\n      clickedRef: useClicked(64),\n      clickedPositionRef: useClickPosition()\n    });\n    provide(modalReactiveListInjectionKey, modalListRef);\n    provide(modalProviderInjectionKey, {\n      clickedRef,\n      clickedPositionRef\n    });\n    return Object.assign(Object.assign({}, api), {\n      modalList: modalListRef,\n      modalInstRefs,\n      handleAfterLeave\n    });\n  },\n  render() {\n    var _a, _b;\n    return h(Fragment, null, [this.modalList.map(modal => {\n      var _a;\n      return h(NModalEnvironment, omit(modal, ['destroy', 'style'], {\n        internalStyle: modal.style,\n        to: (_a = modal.to) !== null && _a !== void 0 ? _a : this.to,\n        ref: inst => {\n          if (inst === null) {\n            // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n            delete this.modalInstRefs[`n-modal-${modal.key}`];\n          } else {\n            this.modalInstRefs[`n-modal-${modal.key}`] = inst;\n          }\n        },\n        internalKey: modal.key,\n        onInternalAfterLeave: this.handleAfterLeave\n      }));\n    }), (_b = (_a = this.$slots).default) === null || _b === void 0 ? void 0 : _b.call(_a)]);\n  }\n});"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}