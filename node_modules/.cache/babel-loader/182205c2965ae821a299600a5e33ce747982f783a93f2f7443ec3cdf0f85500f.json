{"ast":null,"code":"import { unref as _unref, createElementVNode as _createElementVNode, isRef as _isRef, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '@/assets/imgs/blog/评论.svg';\nimport _imports_1 from '@/assets/imgs/blog/点赞.svg';\nconst _withScopeId = n => (_pushScopeId(\"data-v-56b7c2be\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  key: 0,\n  class: \"comment-body\"\n};\nconst _hoisted_2 = {\n  class: \"comment-head\"\n};\nconst _hoisted_3 = {\n  class: \"comment-input\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = {\n  class: \"comment-main\"\n};\nconst _hoisted_6 = {\n  class: \"comment\"\n};\nconst _hoisted_7 = {\n  class: \"comment-content\"\n};\nconst _hoisted_8 = {\n  class: \"comment-content-left\"\n};\nconst _hoisted_9 = [\"src\"];\nconst _hoisted_10 = {\n  class: \"comment-content-right\"\n};\nconst _hoisted_11 = {\n  class: \"comment-user-name\"\n};\nconst _hoisted_12 = {\n  class: \"comment-time\"\n};\nconst _hoisted_13 = {\n  class: \"comment-text\"\n};\nconst _hoisted_14 = {\n  class: \"comment-info\"\n};\nconst _hoisted_15 = [\"onClick\"];\nconst _hoisted_16 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0\n}, null, -1));\nconst _hoisted_17 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"回复\", -1));\nconst _hoisted_18 = [_hoisted_16, _hoisted_17];\nconst _hoisted_19 = [\"onClick\"];\nconst _hoisted_20 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0\n}, null, -1));\nconst _hoisted_21 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"收起\", -1));\nconst _hoisted_22 = [_hoisted_20, _hoisted_21];\nconst _hoisted_23 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"comment-info-item\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", null, \"1\"), /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_1\n})], -1));\nconst _hoisted_24 = {\n  key: 0,\n  class: \"comment-input\",\n  style: {\n    \"width\": \"90%\"\n  }\n};\nconst _hoisted_25 = [\"onClick\"];\nconst _hoisted_26 = {\n  class: \"comment-content\"\n};\nconst _hoisted_27 = {\n  class: \"comment-content-left\"\n};\nconst _hoisted_28 = [\"src\"];\nconst _hoisted_29 = {\n  class: \"comment-content-right\"\n};\nconst _hoisted_30 = {\n  class: \"comment-user-name\"\n};\nconst _hoisted_31 = {\n  class: \"comment-time\"\n};\nconst _hoisted_32 = {\n  class: \"comment-text\"\n};\nconst _hoisted_33 = {\n  key: 0\n};\nconst _hoisted_34 = {\n  class: \"comment-info\"\n};\nconst _hoisted_35 = [\"onClick\"];\nconst _hoisted_36 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0\n}, null, -1));\nconst _hoisted_37 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"回复\", -1));\nconst _hoisted_38 = [_hoisted_36, _hoisted_37];\nconst _hoisted_39 = [\"onClick\"];\nconst _hoisted_40 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0\n}, null, -1));\nconst _hoisted_41 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", null, \"收起\", -1));\nconst _hoisted_42 = [_hoisted_40, _hoisted_41];\nconst _hoisted_43 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"comment-info-item\"\n}, [/*#__PURE__*/_createElementVNode(\"span\", null, \"1\"), /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_1\n})], -1));\nconst _hoisted_44 = {\n  key: 0,\n  class: \"comment-input\",\n  style: {\n    \"width\": \"90%\"\n  }\n};\nconst _hoisted_45 = [\"onClick\"];\nimport { ref, onMounted, inject } from 'vue';\nimport { getCommentList, addComment, addReply } from '@/api/comment.js';\nimport { useRoute } from 'vue-router';\nimport { ElMessage } from 'element-plus';\nexport default {\n  __name: 'Index',\n  setup(__props) {\n    let isReply = ref(false);\n    const route = useRoute();\n    let articleId = route.query.articleId;\n    let commentListTemp = null;\n    let commentList = ref(null);\n    let total = ref(0);\n    let userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\n    let isLogin = ref(false);\n    let beforeCommentId = null;\n    let beforeReplyId = null;\n    let commentInput = ref('');\n    let replyInput = ref('');\n    let parentId = \"0\";\n    const imgDownload = inject('globalImgDownload');\n    onMounted(() => {\n      getComments(1, 5);\n      if (userInfo != null) {\n        isLogin.value = true;\n        // console.log(userInfo);\n      }\n    });\n    function getComments(pageNumber, pageSize) {\n      getCommentList(articleId, pageNumber, pageSize).then(res => {\n        if (res.data == null) {\n          return;\n        }\n        total.value = res.data.total;\n        commentList.value = res.data.records;\n        commentList.value.forEach(comment => {\n          //为每个对象添加新属性\n          Object.assign(comment, {\n            isReply: false\n          });\n          // 如果replyDtoList不为null，则为每个对象添加新属性\n          if (comment.replyDtoList) {\n            comment.replyDtoList.forEach(reply => {\n              Object.assign(reply, {\n                isReply: false\n              });\n            });\n          }\n        });\n        // commentListTemp=[...commentList.value];\n      });\n    }\n    function findParentUserName(comment, parentId) {\n      const parentComment = comment.replyDtoList.find(replyDto => replyDto.reply.id === parentId);\n      return parentComment ? parentComment.userName : '';\n    }\n    function toComment(commentId) {\n      // commentList.value=commentListTemp;\n      // console.log(commentListTemp)\n      // commentList.value=Object.assign([], commentListTemp);\n      if (beforeCommentId != null) {\n        if (beforeReplyId != null) {\n          cancelReply();\n        } else {\n          cancelComment();\n        }\n      }\n      parentId = \"0\";\n      replyInput.value = '';\n      beforeCommentId = commentId;\n      commentList.value.find(comment => comment.commentDto.comment.id === commentId).isReply = true;\n      // if(comment){\n      // \tcomment.isReply=true;\n      // }\n    }\n    function cancelComment() {\n      commentList.value.find(comment => comment.commentDto.comment.id === beforeCommentId).isReply = false;\n      beforeCommentId = null;\n      // commentList.value.find(comment=>comment.commentDto.comment.id===commentId).isReply=false;\n    }\n    function toReply(commentId, replyId) {\n      replyInput.value = '';\n      if (beforeCommentId != null) {\n        if (beforeReplyId != null) {\n          cancelReply();\n        } else {\n          cancelComment();\n        }\n      }\n      parentId = replyId;\n      beforeCommentId = commentId;\n      beforeReplyId = replyId;\n      commentList.value.find(comment => comment.commentDto.comment.id === commentId).replyDtoList.find(replyDto => replyDto.reply.id === replyId).isReply = true;\n    }\n    function cancelReply() {\n      // commentList.value.find(comment=>comment.commentDto.comment.id===commentId).replyDtoList.find(replyDto=>replyDto.reply.id===replyId).isReply=false;\n      commentList.value.find(comment => comment.commentDto.comment.id === beforeCommentId).replyDtoList.find(replyDto => replyDto.reply.id === beforeReplyId).isReply = false;\n      beforeReplyId = null;\n      beforeCommentId = null;\n    }\n    function setComment() {\n      let co = {\n        \"articleId\": articleId,\n        \"userId\": userInfo.id,\n        \"content\": commentInput.value\n      };\n      addComment(co).then(res => {\n        ElMessage({\n          message: '评论成功',\n          type: 'success'\n        });\n        getComments(1, 5);\n      });\n    }\n    function setReply(commentId) {\n      let re = {\n        \"commentId\": commentId,\n        \"userId\": userInfo.id,\n        \"parentId\": parentId,\n        \"content\": replyInput.value\n      };\n      addReply(re).then(res => {\n        ElMessage({\n          message: '评论成功',\n          type: 'success'\n        });\n        getComments(1, 5);\n      });\n    }\n    return (_ctx, _cache) => {\n      return _unref(isLogin) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"img\", {\n        class: \"comment-user-avatar\",\n        src: _unref(imgDownload) + _unref(userInfo).avatar,\n        style: {\n          \"margin-right\": \"5px\"\n        }\n      }, null, 8, _hoisted_4), _withDirectives(_createElementVNode(\"textarea\", {\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _isRef(commentInput) ? commentInput.value = $event : commentInput = $event),\n        maxlength: \"1000\"\n      }, null, 512), [[_vModelText, _unref(commentInput)]]), _createElementVNode(\"div\", {\n        class: \"comment-input-button\",\n        onClick: _cache[1] || (_cache[1] = $event => setComment())\n      }, \"评论\")])]), _createElementVNode(\"div\", _hoisted_5, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(commentList), comment => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          class: \"comment-for\",\n          key: comment.commentDto.comment.id\n        }, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"img\", {\n          class: \"comment-user-avatar\",\n          src: _unref(imgDownload) + comment.commentDto.userAvatar\n        }, null, 8, _hoisted_9)]), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"div\", _hoisted_11, _toDisplayString(comment.commentDto.userName), 1), _createElementVNode(\"div\", _hoisted_12, _toDisplayString(comment.commentDto.comment.createTime), 1), _createElementVNode(\"div\", _hoisted_13, _toDisplayString(comment.commentDto.comment.content), 1), _createElementVNode(\"div\", _hoisted_14, [!comment.isReply ? (_openBlock(), _createElementBlock(\"div\", {\n          key: 0,\n          class: \"comment-info-item\",\n          onClick: $event => toComment(comment.commentDto.comment.id)\n        }, _hoisted_18, 8, _hoisted_15)) : (_openBlock(), _createElementBlock(\"div\", {\n          key: 1,\n          class: \"comment-info-item\",\n          onClick: $event => cancelComment(comment.commentDto.comment.id)\n        }, _hoisted_22, 8, _hoisted_19)), _hoisted_23])])]), comment.isReply ? (_openBlock(), _createElementBlock(\"div\", _hoisted_24, [_withDirectives(_createElementVNode(\"textarea\", {\n          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _isRef(replyInput) ? replyInput.value = $event : replyInput = $event),\n          maxlength: \"1000\",\n          style: {\n            \"height\": \"120px\"\n          }\n        }, null, 512), [[_vModelText, _unref(replyInput)]]), _createElementVNode(\"div\", {\n          class: \"comment-input-button\",\n          onClick: $event => setReply(comment.commentDto.comment.id)\n        }, \"评论\", 8, _hoisted_25)])) : _createCommentVNode(\"\", true), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(comment.replyDtoList, replyDto => {\n          return _openBlock(), _createElementBlock(\"div\", {\n            class: \"comment-item-for\",\n            key: replyDto.reply.id\n          }, [_createElementVNode(\"div\", _hoisted_26, [_createElementVNode(\"div\", _hoisted_27, [_createElementVNode(\"img\", {\n            class: \"comment-user-avatar\",\n            src: _unref(imgDownload) + replyDto.userAvatar\n          }, null, 8, _hoisted_28)]), _createElementVNode(\"div\", _hoisted_29, [_createElementVNode(\"div\", _hoisted_30, _toDisplayString(replyDto.userName), 1), _createElementVNode(\"div\", _hoisted_31, _toDisplayString(replyDto.reply.createTime), 1), _createElementVNode(\"div\", _hoisted_32, [replyDto.reply.parentId != '0' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_33, [_createTextVNode(\"回复\"), _createElementVNode(\"span\", null, _toDisplayString(findParentUserName(comment, replyDto.reply.parentId)) + \"：\", 1)])) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", null, _toDisplayString(replyDto.reply.content), 1)]), _createElementVNode(\"div\", _hoisted_34, [!replyDto.isReply ? (_openBlock(), _createElementBlock(\"div\", {\n            key: 0,\n            class: \"comment-info-item\",\n            onClick: $event => toReply(comment.commentDto.comment.id, replyDto.reply.id)\n          }, _hoisted_38, 8, _hoisted_35)) : (_openBlock(), _createElementBlock(\"div\", {\n            key: 1,\n            class: \"comment-info-item\",\n            onClick: $event => cancelReply(comment.commentDto.comment.id, replyDto.reply.id)\n          }, _hoisted_42, 8, _hoisted_39)), _hoisted_43])])]), replyDto.isReply ? (_openBlock(), _createElementBlock(\"div\", _hoisted_44, [_withDirectives(_createElementVNode(\"textarea\", {\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => _isRef(replyInput) ? replyInput.value = $event : replyInput = $event),\n            maxlength: \"1000\",\n            style: {\n              \"height\": \"120px\"\n            }\n          }, null, 512), [[_vModelText, _unref(replyInput)]]), _createElementVNode(\"div\", {\n            class: \"comment-input-button\",\n            onClick: $event => setReply(comment.commentDto.comment.id)\n          }, \"评论\", 8, _hoisted_45)])) : _createCommentVNode(\"\", true)]);\n        }), 128))])]);\n      }), 128))])])) : _createCommentVNode(\"\", true);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","inject","getCommentList","addComment","addReply","useRoute","ElMessage","isReply","route","articleId","query","commentListTemp","commentList","total","userInfo","JSON","parse","localStorage","getItem","isLogin","beforeCommentId","beforeReplyId","commentInput","replyInput","parentId","imgDownload","getComments","value","pageNumber","pageSize","then","res","data","records","forEach","comment","Object","assign","replyDtoList","reply","findParentUserName","parentComment","find","replyDto","id","userName","toComment","commentId","cancelReply","cancelComment","commentDto","toReply","replyId","setComment","co","message","type","setReply","re"],"sources":["E:/java项目/blog/blog-front/src/views/comment/Index.vue"],"sourcesContent":["<template>\r\n\t<div class=\"comment-body\" v-if=\"isLogin\">\r\n\t\t<div class=\"comment-head\">\r\n\t\t\t<div class=\"comment-input\">\r\n\t\t\t\t<!-- <img class=\"comment-user-avatar\" src=\"@/assets/imgs/fufu.jpg\" style=\"margin-right: 5px;\"> -->\r\n\t\t\t\t<img class=\"comment-user-avatar\" :src=\"imgDownload + userInfo.avatar\" style=\"margin-right: 5px;\">\r\n\t\t\t\t<textarea v-model=\"commentInput\" maxlength=\"1000\"></textarea>\r\n\t\t\t\t<div class=\"comment-input-button\"  @click=\"setComment()\">评论</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"comment-main\">\r\n\t\t\t<div class=\"comment-for\" v-for=\"comment in commentList\" :key=\"comment.commentDto.comment.id\">\r\n\t\t\t\t<div class=\"comment\">\r\n\t\t\t\t\t<div class=\"comment-content\">\r\n\t\t\t\t\t\t<div class=\"comment-content-left\">\r\n\t\t\t\t\t\t\t<img class=\"comment-user-avatar\" :src=\"imgDownload + comment.commentDto.userAvatar\">\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"comment-content-right\">\r\n\t\t\t\t\t\t\t<div class=\"comment-user-name\">{{ comment.commentDto.userName }}</div>\r\n\t\t\t\t\t\t\t<div class=\"comment-time\">{{ comment.commentDto.comment.createTime }}</div>\r\n\t\t\t\t\t\t\t<div class=\"comment-text\">{{ comment.commentDto.comment.content }}</div>\r\n\t\t\t\t\t\t\t<div class=\"comment-info\">\r\n\t\t\t\t\t\t\t\t<div class=\"comment-info-item\" v-if=\"!comment.isReply\" @click=\"toComment(comment.commentDto.comment.id)\">\r\n\t\t\t\t\t\t\t\t\t<img src=\"@/assets/imgs/blog/评论.svg\">\r\n\t\t\t\t\t\t\t\t\t<span>回复</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"comment-info-item\" v-else @click=\"cancelComment(comment.commentDto.comment.id)\">\r\n\t\t\t\t\t\t\t\t\t<img src=\"@/assets/imgs/blog/评论.svg\">\r\n\t\t\t\t\t\t\t\t\t<span>收起</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"comment-info-item\">\r\n\t\t\t\t\t\t\t\t\t<span>1</span>\r\n\t\t\t\t\t\t\t\t\t<img src=\"@/assets/imgs/blog/点赞.svg\">\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"comment-input\" style=\"width: 90%;\" v-if=\"comment.isReply\">\r\n\t\t\t\t\t\t<textarea v-model=\"replyInput\" maxlength=\"1000\" style=\"height: 120px;\"></textarea>\r\n\t\t\t\t\t\t<div class=\"comment-input-button\" @click=\"setReply(comment.commentDto.comment.id)\">评论</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"comment-item-for\"  v-for=\"replyDto in comment.replyDtoList\" :key=\"replyDto.reply.id\">\r\n\t\t\t\t\t\t<div class=\"comment-content\">\r\n\t\t\t\t\t\t\t<div class=\"comment-content-left\">\r\n\t\t\t\t\t\t\t\t<img class=\"comment-user-avatar\" :src=\"imgDownload + replyDto.userAvatar\">\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"comment-content-right\">\r\n\t\t\t\t\t\t\t\t<div class=\"comment-user-name\">{{replyDto.userName}}</div>\r\n\t\t\t\t\t\t\t\t<div class=\"comment-time\">{{ replyDto.reply.createTime }}</div>\r\n\t\t\t\t\t\t\t\t<div class=\"comment-text\">\r\n\t\t\t\t\t\t\t\t\t<div v-if=\"replyDto.reply.parentId!='0'\">回复<span>{{ findParentUserName(comment, replyDto.reply.parentId) }}：</span></div>\r\n\t\t\t\t\t\t\t\t\t<div>{{ replyDto.reply.content }}</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div class=\"comment-info\">\r\n\t\t\t\t\t\t\t\t\t<div class=\"comment-info-item\" v-if=\"!replyDto.isReply\" @click=\"toReply(comment.commentDto.comment.id,replyDto.reply.id)\">\r\n\t\t\t\t\t\t\t\t\t\t<img src=\"@/assets/imgs/blog/评论.svg\">\r\n\t\t\t\t\t\t\t\t\t\t<span>回复</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"comment-info-item\" v-else @click=\"cancelReply(comment.commentDto.comment.id,replyDto.reply.id)\">\r\n\t\t\t\t\t\t\t\t\t\t<img src=\"@/assets/imgs/blog/评论.svg\">\r\n\t\t\t\t\t\t\t\t\t\t<span>收起</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div class=\"comment-info-item\">\r\n\t\t\t\t\t\t\t\t\t\t<span>1</span>\r\n\t\t\t\t\t\t\t\t\t\t<img src=\"@/assets/imgs/blog/点赞.svg\">\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"comment-input\" style=\"width: 90%;\" v-if=\"replyDto.isReply\">\r\n\t\t\t\t\t\t\t<textarea v-model=\"replyInput\" maxlength=\"1000\" style=\"height: 120px;\"></textarea>\r\n\t\t\t\t\t\t\t<div class=\"comment-input-button\" @click=\"setReply(comment.commentDto.comment.id)\">评论</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\nimport {ref,onMounted,inject} from 'vue'\r\nimport {getCommentList,addComment,addReply} from '@/api/comment.js'\r\nimport { useRoute } from 'vue-router';\r\nimport { ElMessage } from 'element-plus'\r\nlet isReply = ref(false);\r\nconst route = useRoute();\r\nlet articleId=route.query.articleId;\r\nlet commentListTemp=null;\r\nlet commentList=ref(null);\r\nlet total = ref(0);\r\nlet userInfo = JSON.parse(localStorage.getItem(\"userInfo\"));\r\nlet isLogin=ref(false);\r\nlet beforeCommentId=null;\r\nlet beforeReplyId=null;\r\nlet commentInput=ref('');\r\nlet replyInput=ref('');\r\nlet parentId=\"0\";\r\nconst imgDownload = inject('globalImgDownload');\r\n\r\nonMounted(()=>{\r\n\tgetComments(1,5);\r\n\tif(userInfo!=null){\r\n\t\tisLogin.value=true;\r\n\t\t// console.log(userInfo);\r\n\t}\r\n})\r\n\r\nfunction getComments(pageNumber, pageSize){\r\n\tgetCommentList(articleId,pageNumber, pageSize)\r\n\t\t.then(res=>{\r\n\t\t\tif(res.data==null){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\ttotal.value=res.data.total;\r\n\t\t\tcommentList.value=res.data.records;\r\n\t\t\tcommentList.value.forEach(comment=>{\r\n\t\t\t\t//为每个对象添加新属性\r\n\t\t\t\tObject.assign(comment, { isReply: false });\r\n\t\t\t\t// 如果replyDtoList不为null，则为每个对象添加新属性\r\n\t\t\t\tif (comment.replyDtoList) {\r\n\t\t\t\t\tcomment.replyDtoList.forEach(reply => {\r\n\t\t\t\t\t\tObject.assign(reply, { isReply: false });\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// commentListTemp=[...commentList.value];\r\n\t\t\t\r\n\t\t})\r\n}\r\n\r\nfunction findParentUserName(comment, parentId) {\r\n\tconst parentComment = comment.replyDtoList.find(replyDto => replyDto.reply.id === parentId);\r\n\treturn parentComment ? parentComment.userName : '';\r\n}\r\n\r\nfunction toComment(commentId){\r\n\t// commentList.value=commentListTemp;\r\n\t// console.log(commentListTemp)\r\n\t// commentList.value=Object.assign([], commentListTemp);\r\n\tif(beforeCommentId!=null){\r\n\t\tif(beforeReplyId!=null){\r\n\t\t\tcancelReply()\r\n\t\t}else{\r\n\t\t\tcancelComment()\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tparentId=\"0\"\r\n\treplyInput.value='';\r\n\tbeforeCommentId=commentId\r\n\tcommentList.value.find(comment=>comment.commentDto.comment.id===commentId).isReply=true;\r\n\t// if(comment){\r\n\t// \tcomment.isReply=true;\r\n\t// }\r\n}\r\n\r\nfunction cancelComment(){\r\n\t\r\n\tcommentList.value.find(comment=>comment.commentDto.comment.id===beforeCommentId).isReply=false;\r\n\tbeforeCommentId=null;\r\n\t// commentList.value.find(comment=>comment.commentDto.comment.id===commentId).isReply=false;\r\n\r\n}\r\n\r\nfunction toReply(commentId,replyId){\r\n\treplyInput.value='';\r\n\tif(beforeCommentId!=null){\r\n\t\tif(beforeReplyId!=null){\r\n\t\t\tcancelReply()\r\n\t\t}else{\r\n\t\t\tcancelComment()\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tparentId=replyId;\r\n\tbeforeCommentId=commentId;\r\n\tbeforeReplyId=replyId;\r\n\tcommentList.value.find(comment=>comment.commentDto.comment.id===commentId).replyDtoList.find(replyDto=>replyDto.reply.id===replyId).isReply=true;\r\n\r\n}\r\n\r\nfunction cancelReply(){\r\n\r\n\t// commentList.value.find(comment=>comment.commentDto.comment.id===commentId).replyDtoList.find(replyDto=>replyDto.reply.id===replyId).isReply=false;\r\n\tcommentList.value.find(comment=>comment.commentDto.comment.id===beforeCommentId).replyDtoList.find(replyDto=>replyDto.reply.id===beforeReplyId).isReply=false;\r\n\tbeforeReplyId=null;\r\n\tbeforeCommentId=null;\r\n}\r\nfunction setComment(){\r\n\tlet co = {\r\n\t\t\"articleId\":articleId,\r\n\t\t\"userId\":userInfo.id,\r\n\t\t\"content\":commentInput.value\r\n\t}\r\n\taddComment(co)\r\n\t.then(res=>{\r\n\t\tElMessage({\r\n\t\t\tmessage: '评论成功',\r\n\t\t\ttype: 'success',\r\n\t\t})\r\n\t\tgetComments(1,5);\r\n\t})\r\n}\r\n\r\nfunction setReply(commentId){\r\n\tlet re = {\r\n\t\t\"commentId\":commentId,\r\n\t\t\"userId\":userInfo.id,\r\n\t\t\"parentId\":parentId,\r\n\t\t\"content\":replyInput.value\r\n\t}\r\n\taddReply(re)\r\n\t.then(res=>{\r\n\t\tElMessage({\r\n\t\t\tmessage: '评论成功',\r\n\t\t\ttype: 'success',\r\n\t\t})\r\n\t\tgetComments(1,5);\r\n\t})\r\n}\r\n</script>\r\n\r\n\r\n<style src=\"@/assets/css/comment.css\" scoped>\r\n\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}