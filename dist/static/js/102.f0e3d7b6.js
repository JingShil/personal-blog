"use strict";(self["webpackChunkblog_front"]=self["webpackChunkblog_front"]||[]).push([[102],{8021:function(e,t,l){l.d(t,{Tn:function(){return i},UN:function(){return a},_R:function(){return s}});var n=l(7267);function i(e){return(0,n.A)({url:"/tag/list",method:"get",params:{name:e}})}function a(e){return(0,n.A)({url:"/tag/save",method:"post",data:e})}function s(e){return(0,n.A)({url:"/tag/delete",method:"delete",params:{tagId:e}})}},9132:function(e,t,l){l.r(t),l.d(t,{default:function(){return G}});l(4114);var n=l(4055),i=l(5167),a=l(1469),s=l(7959),u=l(7153),d=l.p+"static/img/目录.8d8edaba.svg",c=l.p+"static/img/标签.1e9719d5.svg",o=l.p+"static/img/AI-chat.5c0c6d33.svg",r=l.p+"static/img/帮助与说明.fbc27bbb.svg",p=l(9460),v=l.n(p),m=l(8021),g=l(2999),h=l(3229),f=l(1174),k=l(4127);const L=e=>((0,n.Qi)("data-v-4fa1be18"),e=e(),(0,n.jt)(),e),b={class:"edit-body"},y={class:"edit-head"},C={class:"edit-title-input"},N=L((()=>(0,n.Lk)("span",null,"0/100",-1))),I=L((()=>(0,n.Lk)("img",{src:u,style:{height:"40px","margin-left":"20px","border-radius":"30px"}},null,-1))),R={class:"edit-container"},w=L((()=>(0,n.Lk)("div",{class:"edit-left"},[(0,n.Lk)("div",{class:"edit-content",id:"vditor"})],-1))),x={class:"edit-right"},E={class:"edit-help"},_=L((()=>(0,n.Lk)("img",{src:d},null,-1))),K=L((()=>(0,n.Lk)("span",null,"目录",-1))),T=[_,K],H=L((()=>(0,n.Lk)("img",{src:c},null,-1))),X=L((()=>(0,n.Lk)("span",null,"标签",-1))),A=[H,X],j=L((()=>(0,n.Lk)("div",{class:"edit-help-item"},[(0,n.Lk)("img",{src:o}),(0,n.Lk)("span",null,"AI助手")],-1))),V=L((()=>(0,n.Lk)("div",{class:"edit-help-item"},[(0,n.Lk)("img",{src:r}),(0,n.Lk)("span",null,"语法")],-1))),F={class:"edit-help-content"},q={key:0,class:"edit-help-content-item"},B=L((()=>(0,n.Lk)("div",{class:"edit-help-content-head"},[(0,n.Lk)("span",null,"文章目录")],-1))),M={class:"edit-help-catalog"},Q=["id","onClick"],U={key:1,class:"edit-help-content-item"},S=L((()=>(0,n.Lk)("div",{class:"edit-help-content-head"},[(0,n.Lk)("span",null,"标签")],-1))),W={class:"edit-help-tag"},D=["onClick"],J="http://43.129.171.44:8081/img/upload";var O={__name:"Index",setup(e){const t=(0,h.lq)(),l=(0,i.KR)();let u=(0,i.KR)([]),d=(0,i.KR)(0),c=(0,i.KR)([]),o={},r=(0,i.KR)([]),p=null;const L=(0,i.KR)(null);let _=(0,i.KR)({id:null,title:"",content:"",published:null,likeNum:null,collectNum:null,viewNum:null,commentNum:null,createTime:null,updateTime:null});function K(e){d.value=e}function H(e){for(let t of r.value)if(t.id==e)return!0;return!1}function X(){null!=p&&(0,g.X1)(p).then((e=>{r.value=e.data.tagList,_.value=e.data.article,l.value.setValue(_.value.content),Y()}))}function O(e){for(let t of r.value)if(t.id==e.id)return void(r.value=r.value.filter((t=>t.id!==e.id)));r.value.push(e)}function P(){null!=_.value.id&&(L.value=setInterval((()=>{z(_.value.published)}),3e4))}function z(e){let t=l.value.getValue();null==t&&(t=""),null==_.value.title&&(_.value.title="无标题"),_.value.content=t,_.value.published=e,o={article:_.value,tagList:r.value},f.s.confirm("确定保存吗？",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,g.UN)(o).then((e=>{1==e.code?(0,k.nk)({type:"success",message:"保存成功"}):(0,k.nk)({type:"info",message:"保存失败"})}))})).catch((()=>{(0,k.nk)({type:"info",message:"取消"})}))}function G(){(0,m.Tn)().then((e=>{c.value=e.data}))}function Y(){const e=l.value.getCurrentMode(),t=document.getElementsByClassName("vditor-reset"),n=["H1","H2","H3","H4","H5","H6"];let i=null,a=null,s="ir";i=t[2],"wysiwyg"===e?(a=t[0],s="wysiwyg"):"sv"===e?(a=t[1],s="sv"):"ir"===e&&(a=t[2],s="ir");let d=[];i.childNodes.forEach(((e,t)=>{if(n.includes(e.nodeName)){const e=s+"-"+t;d.push(e),a.childNodes[t].id=e}}));const c=(new DOMParser).parseFromString(l.value.getHTML(),"text/html");let o=[];const r=Array.from(c.body.childNodes);let p=0,v=0;r.forEach(((e,t)=>{if(n.includes(e.nodeName)){const t=d[v++];p=Number(e.nodeName.substring(1,2)),o.push({id:t,title:e.innerHTML,level:p,nodeName:e.nodeName})}})),u.value=o}function Z(e){const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"instant"})}return null!=t.query.articleId&&(p=t.query.articleId),(0,n.sV)((()=>{l.value=new(v())("vditor",{width:"100%",height:"80vh",tab:"\t",toolbar:["emoji","headings","bold","italic","strike","|","line","quote","list","ordered-list","check","code","inline-code","insert-after","insert-before","undo","redo","link","table","edit-mode","both","content-theme","export","upload"],hljs:{style:"manni"},input(e){Y()},after(){l.value.setValue(""),X(),P()},upload:{multiple:!1,url:J,accept:"image/jpg, image/jpeg, image/png",fieldName:"file",max:10485760,headers:{Token:localStorage.getItem("token")}}}),G()})),(0,n.KC)((()=>{clearInterval(L.value)})),(e,t)=>{const l=(0,n.g2)("el-button");return(0,n.uX)(),(0,n.CE)("div",b,[(0,n.Lk)("div",y,[(0,n.Lk)("div",C,[(0,n.bo)((0,n.Lk)("input",{placeholder:"请输入标题",maxlength:"100","onUpdate:modelValue":t[0]||(t[0]=e=>(0,i.R1)(_).title=e)},null,512),[[a.Jo,(0,i.R1)(_).title]]),N]),(0,n.bF)(l,{class:"edit-save"},{default:(0,n.k6)((()=>[(0,n.eW)("保存")])),_:1}),(0,n.bF)(l,{type:"primary",onClick:t[1]||(t[1]=e=>z(1))},{default:(0,n.k6)((()=>[(0,n.eW)("发布")])),_:1}),I]),(0,n.Lk)("div",R,[w,(0,n.Lk)("div",x,[(0,n.Lk)("div",E,[(0,n.Lk)("div",{class:"edit-help-item",onClick:t[2]||(t[2]=e=>K(0))},T),(0,n.Lk)("div",{class:"edit-help-item",onClick:t[3]||(t[3]=e=>K(1))},A),j,V]),(0,n.Lk)("div",F,[0==(0,i.R1)(d)?((0,n.uX)(),(0,n.CE)("div",q,[B,(0,n.Lk)("div",M,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,i.R1)(u),((e,t)=>((0,n.uX)(),(0,n.CE)("div",{class:"edit-help-catalog-for",key:t},[(0,n.Lk)("span",{id:e.id,style:(0,s.Tr)({marginLeft:20*e.level+"px"}),onClick:t=>Z(e.id)},(0,s.v_)(e.title),13,Q)])))),128))])])):(0,n.Q3)("",!0),1==(0,i.R1)(d)?((0,n.uX)(),(0,n.CE)("div",U,[S,(0,n.Lk)("div",W,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)((0,i.R1)(c),((e,t)=>((0,n.uX)(),(0,n.CE)("div",{class:"edit-help-tag-for",key:t},[(0,n.Lk)("span",{class:(0,s.C4)(["edit-tag",{"edit-tag-select":H(e.id)}]),type:"primary",onClick:t=>O(e)},(0,s.v_)(e.name),11,D)])))),128))])])):(0,n.Q3)("",!0)])])])])}}},P=l(5932);const z=(0,P.A)(O,[["__scopeId","data-v-4fa1be18"]]);var G=z},7153:function(e,t,l){e.exports=l.p+"static/img/fufu.c482465b.jpg"}}]);
//# sourceMappingURL=102.f0e3d7b6.js.map